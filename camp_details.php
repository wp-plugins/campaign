<?phpfunction camp_details($campid) {        $get_campinfo = get_post($campid);    $brandname = get_post_meta($campid, 'camp_brand', true);    $experience = get_post_meta($campid, 'camp_exp', true);    $video = get_post_meta($campid, 'camp_video', true);    $attachment_id = get_post_meta($campid, '_camp_pic', true);    $image_arr = wp_get_attachment_image_src($attachment_id, 'thumbnail');    $amount_to_acheive = get_user_meta($get_campinfo->post_author, '_amount_to_achieve', true);    $time_to_acheive = get_user_meta($get_campinfo->post_author, '_time_to_achieve', true);    $current_date = date('Y-m-d');    $time_left = ( strtotime($time_to_acheive) - strtotime($current_date));    $time = date('z', $time_left);    if($time_to_acheive == '')        $time = 'Not Given';    if (isset($_POST['donate_submit'])) {        global $wpdb, $table_prefix;        $donate_amount = strip_tags(trim($_POST['donate_amt']));        $doner_name = strip_tags(trim($_POST['funder_name']));        $doner_email = strip_tags(trim($_POST['funder_email']));        $camp_owner_id = $_POST['camp_owner_id'];        $paypal_type = get_option('paypal_type');        $live_id = get_option('live_id');        $sandbox_id = get_option('sandbox_id');        if ($donate_amount == '') {            $msg = 'Please Give Donate Amount';        } else if ($doner_name == '') {            $msg = 'Please Enter Your Name';        } else if ($doner_email == '') {            $msg = 'Please Enter Your Email Address';        } else {            if ($paypal_type == 'sandbox') {                $action = 'https://www.sandbox.paypal.com/cgi-bin/webscr?';                $username = $sandbox_id;            } else {                $action = 'https://www.paypal.com/cgi-bin/webscr?';                $username = $live_id;            }            $custom = $campid . '#' . $camp_owner_id . '#' . $doner_name . '#' . $doner_email . '#' . $donate_amount;            $query_string = 'cmd=_xclick&business=' . urlencode($username) . '&item_name=' . urlencode('Funding') . '&item_number=1&custom=' . urlencode($custom) . '&amount=' . urlencode($donate_amount) . '&no_shipping=0&no_note=1&currency_code=' . urlencode('GBP') . '&return=' . urlencode(get_option('siteurl') . '/fund-designer/') . '?action=success&cancel_return=' . urlencode(get_option('siteurl') . '/fund-designer/') . '?payment=false&notify_url=' . urlencode(get_option('siteurl') . '/fund-designer/') . '?ipn=true';            wp_redirect($action . $query_string);            exit;        }        set_transient('donate_msg', $msg, 30);        wp_safe_redirect(get_permalink() . '?cp_details=' . $campid);        exit;    }    $str = '';    $str.= get_transient('donate_msg');    delete_transient('donate_msg');    $str.=' <div class="sponsor_wrapper">';    $str.= '<div class="sm_nav">';    $str.= '<div class="sm_nav_left">Recently Added Campaign</div>';    $str.= '<div  class="sm_nav_right">';    $str.= '<div class="sm_search_log">';    $str.= '<form name="camp_frm" method="get" action="" >';    $str.= '<input type="text" name="camp_search" value="Enter your keyword" class="search_filed" onclick="if (this.defaultValue==this.value) this.value=\'\'" onblur="if (this.value==\'\') this.value=this.defaultValue" />';    $str.= '<input type="submit" name="camp_search_submit" value="Go" class="search_btn" />';    $str.= '</form>';    $str.= '</div>';    $str.= '<div class="sm_reg_log"><a href="' . get_permalink() . '/?cp_login">Login</a> <a href="' . get_permalink() . '/?cp_reg">Register</a></div>';    $str.= '</div>';    $str.= '</div>';    $str.= '<div class="view_detail_wrap">';    $str.= '<div class="view_detail_img" style="background:#fff;">';    $str.='<img style="display:block; padding:3px; border:1px solid #b6bac0;" src="' . $image_arr[0] . '" />';    $str.= '</div>';    $str.= '<div class="view_detail_top">';    $str.= '<div class="detail_right">';    $str.= '<div class="detail_title"><span>Title:</span>' . $get_campinfo->post_title . '</div>';    $str.='<div class="detail_brand"><span>Brand Name:</span>' . $brandname . '</div>';    $str.='<div class="detail_expe"><span>Experience:</span>' . $experience . ' Year</div>';    $str .='<div class="achieve_amt"><span>Raise Funds:</span>' . $amount_to_acheive . ' &pound;</div>';    $str .='<div class="achieve_time"><span>Time Left:</span>' . $time . ' Days</div>';    $str.=' </div>';    $str.= '<div class="de_info"><span>Designer Info:</span>' . $get_campinfo->post_content . '</div>';    $str.= '<div class="youtub_video">';    $str.= $video;    $str.= '</div>';    $str.='<div class="login_wrap" style="margin-top:10px; margin-bottom:10px; padding:12px 0 0 0;">';    $str.='<h2 style="font-size:14px; color:#e3564f; text-indent:16px;">Please Donate</h2>';    $str.='<div id="cp_donate_form_msg" style="display: none;"></div>';    $str.= '<form name="donate_frm" method="post" action="" onsubmit="return donate_form_valid();">';    $str.='<input type="hidden" name="camp_owner_id" value="' . $get_campinfo->post_author . '" />';    $str.= '<div class="log_field_con">';    $str.= '<label>Donate Amount:</label>';    $str.= ' <input type="text" name="donate_amt" id="donate_amount" value="" class="logIn_field" /><span style="color:#e75952; padding:0 0 0 3px;">(&pound;)</span>';    $str.= '</div>';    $str.= '<div class="log_field_con">';    $str.='<label>Funder Name:</label>';    $str.= '<input type="text" name="funder_name" id="funder_name" value="" class="logIn_field" />';    $str.= '</div>';    $str.= '<div class="log_field_con">';    $str.= '<label>Funder Email:</label>';    $str.= '<input type="text" name="funder_email" id="funder_email" value="" class="logIn_field" />';    $str.= '</div>';    $str.= '<div class="log_field_con">';    $str.= '<label>&nbsp;</label>';    $str.= '<input type="submit" name="donate_submit" value="Donate" class="login_btn" />';    $str.= '</div>';    $str .='<div style="color: #e3564f;float: left;display: block;font: bold 14px "Times New Roman", Times, serif;">You will need a registered paypal account to dontate</div>';    $str.= '</form>';    $str.= '</div>';    $str.= '</div>';    $str.= '</div>';    $str.= '</div>';    return $str;}?>